# Pen-test Checklist (TherapyEngine)

## App & API
- [ ] TLS enforced (HSTS, modern ciphers)
- [ ] Rate limiting on /auth, /api/generateTherapy, /push
- [ ] AuthZ: RBAC for /admin/*; API keys for partner endpoints
- [ ] JWT: short-lived (7d) + proper signing; rotation plan
- [ ] Input validation & sanitization (JSON, file uploads)
- [ ] Error handling (no secrets in responses)
- [ ] Secrets management (env only; no hard-coded keys)
- [ ] Logging: pino structured; sensitive fields redacted

## Data
- [ ] AES-256-GCM encryption for therapy payloads (DATA_KEY)
- [ ] Backups encrypted; restore tested
- [ ] Data retention policy; GDPR Delete/Export verified

## Mobile
- [ ] Secure storage of tokens (Keychain/Keystore via Capacitor)
- [ ] Biometric lock tested
- [ ] Push tokens revoked on logout

## Infra
- [ ] Nginx rate limit + WAF rules (optional)
- [ ] Dependency updates, SCA scan (npm audit, osv-scanner)
- [ ] Monitoring: /metrics scraped; alerts configured
